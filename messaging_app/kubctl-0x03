#!/bin/bash

echo "ğŸš€ Applying updated blue deployment (v2.0)..."
kubectl apply -f blue_deployment.yaml

echo "â³ Monitoring rolling update status..."
kubectl rollout status deployment/django-blue

echo "ğŸŒ Starting availability test with curl..."
for i in {1..20}; do
    curl -s http://localhost:8000/ > /dev/null
    echo "Request $i sent at $(date)"
    sleep 1
done

echo "ğŸ” Verifying current running pods..."
kubectl get pods -l app=django-messaging
