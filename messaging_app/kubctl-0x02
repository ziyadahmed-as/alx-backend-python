#!/bin/bash

echo "🚀 Applying Blue Deployment..."
kubectl apply -f blue_deployment.yaml

echo "🚀 Applying Green Deployment..."
kubectl apply -f green_deployment.yaml

echo "🔄 Applying Service to Route Traffic..."
kubectl apply -f kubeservice.yaml

echo "⏳ Waiting for pods to start..."
sleep 10

echo "🔍 Checking Green Deployment Logs..."
GREEN_POD=$(kubectl get pods -l version=green -o jsonpath="{.items[0].metadata.name}")
kubectl logs "$GREEN_POD"

echo "✅ Current Running Pods:"
kubectl get pods -l app=django-messaging
